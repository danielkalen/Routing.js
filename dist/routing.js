!function(t){return function(){var t;return t=function(t,e,r,n){return n=function(n){return r[n]?e[n]:(r[n]=1,e[n]={},e[n]=t[n](e[n]))},t[1]=function(t){var e={exports:t},r,o,i;return r=n(4),i=n(2),e.exports=o=function(){function t(t,e){this.timeout=t,this.ID=e,isNaN(this.timeout)&&(this.timeout=2500),this.listening=!1,this.routes=[],this._p=1,this._r={},this._c={},this._h=[],this._f=[],this._gB=this._gA=i.noop,this._P=Promise.resolve(),this.current=this.prev={route:null,path:null}}return t.prototype._A=function(t){return this.routes.push(t),this.routes.sort(function(t,e){var r,n,o,i,s;return s=e.segments.length-t.segments.length,s||(r=(null!=(o=t.segments.dynamic)?o.length:void 0)||0,n=(null!=(i=e.segments.dynamic)?i.length:void 0)||0,s=n-r),s}),t},t.prototype._removeRoute=function(t){var e,r,n,o;return e=Object.keys(this._c),r=Object.keys(this._r),n=e.filter(function(e){return function(r){return e._c[r]===t}}(this))[0],o=e.filter(function(e){return function(r){return e._r[r]===t}}(this))[0],i.rI(this.routes,t),delete this._c[n],delete this._r[o]},t.prototype._M=function(t){var e,r,n,o,i,s,u,h,a,c,l,p,f;if(!(u=this._c[t]))for(c=this.routes,n=0,i=c.length;n<i;n++)if(l=c[n],l.path.test(t)){if(l.segments.dynamic&&l._d){for(h=!0,f||(f=t.split("/")),r=o=0,s=f.length;o<s&&(p=f[r],p!==l.segments[r]&&(e=l.segments.dynamic[r],(h=null!=e)&&l._d[e]&&(h=l._d[e](p))),h);r=++o);if(!h)continue}if(!this._hp){u=l;break}l._ps?(a||(a=[]),a.push(l)):u||(u=l)}if(a&&(u&&a.push(u),u=a),u)return this._c[t]=u},t.prototype._go=function(t,e,r,n){return t.constructor===Array?Promise.all(t.map(function(t){return function(o){return t._go(o,e,r,n)}}(this))):(e=i.aB(e,this._bp),r&&!t._ps&&(e!==i.currentPath()&&(window.location.hash=e),"redirect"===n&&(this.current=this.prev,this._h.pop()),this.current.route&&"back"!==n&&this._h.push(this.current),n||(this._f.length=0),this.prev=i.cO(this.current),this.current={route:t,path:e}),this._P=this._P.then(function(r){return function(){return new Promise(function(n,o){return setTimeout(function(){return o(new Error("TimeoutError: '"+e+"' failed to load within "+r.timeout+"ms (Router #"+r.ID+")"))},r.timeout),Promise.resolve().then(r._gB).then(function(){var t;return null!=(t=r.prev.route)?t._L(r.current.route,r.current.path):void 0}).then(function(){return t._R(e,r.prev.route,r.prev.path)}).then(r._gA).then(n).catch(o)})}}(this)),this._P.catch(function(t){return function(e){return i.lE(e),t._P=Promise.resolve(),t._F?t._go(t._F,t.current.path):t._go(t.prev.route,t.prev.path,!0,"back")}}(this)))},t.prototype.go=function(t,e){var r,n;return"string"==typeof t&&(n=i.cP(t),n=i.rB(n,this._bp),r=this._M(n),r||(r=this._F),r&&n!==this.current.path&&this._go(r,n,!0,e)),this._P},t.prototype.map=function(t){var e,n,o;return t=i.cP(t),o=i.pP(t),e=this._r[t],e||(n=i.sRE(o),e=this._r[t]=new r(n,o,this),this._A(e)),e},t.prototype.mapOnce=function(t){return this.map(t).to(function(){return this.remove()})},t.prototype.listen=function(t){return null==t&&(t=!0),this.listening=!0,Routing._registerRouter(this,t),this},t.prototype.beforeAll=function(t){return this._gB=t,this},t.prototype.afterAll=function(t){return this._gA=t,this},t.prototype.base=function(t){return this._bp=i.pRE(i.cP(t),!0),this},t.prototype.priority=function(t){return t&&"number"==typeof t&&(this._p=t),this},t.prototype.fallback=function(t){return this._F=new r("*FALLBACK*",[],this),this._F.to(t),this},t.prototype.back=function(){var t;return this.current.route&&this._f.unshift(this.current),t=this._h.pop(),t?this._go(t.route,t.path,!0,"back"):Promise.resolve()},t.prototype.forward=function(){var t;return t=this._f.shift(),t?this._go(t.route,t.path,!0,"forward"):Promise.resolve()},t.prototype.refresh=function(){return this.current.route&&(this.prev.path=this.current.path,this.prev.route=this.current.route,this._go(this.current.route,this.current.path)),this._P},t.prototype.kill=function(){this._r={},this._c={},this.routes.length=this._h.length=this._f.length=0,this._gB=this._gA=i.noop,this._F=null,this.current.route=this.current.path=this.prev.route=this.prev.path=null},t}(),e.exports},t[2]=function(t){var e={exports:t},r;return e.exports=r={},r.noop=function(){return Promise.resolve()},r.currentPath=function(){return r.cP(window.location.hash)},r.cO=function(t){var e,r,n;r={};for(e in t)n=t[e],r[e]=n;return r},r.rI=function(t,e){var r;return r=t.indexOf(e),t.splice(r,1),t},r.lE=function(t){t instanceof Error||(t=new Error(t)),null!=("undefined"!=typeof console&&null!==console?console.error:void 0)?console.error(t):null!=("undefined"!=typeof console&&null!==console?console.log:void 0)&&console.log(t)},r.aB=function(t,e){return e&&!e.test(t)?e.string+"/"+t:t},r.rB=function(t,e){return e&&e.test(t)&&(t=t.slice(e.length+1),t.length||(t="/")),t},r.cP=function(t){return"#"===t[0]&&(t=t.slice(1)),0===t.length?t="/":t.length>1&&("/"===t[0]&&(t=t.slice(1)),"/"===t[t.length-1]&&(t=t.slice(0,-1))),t},r.pP=function(t){var e,r,n,o,i,s,u,h;if("/"===t)return["/"];for(o=u=!1,n="",h=[],s=t.length,i=-1,e=function(){var t;return h.push(n),t=h.length-1,o&&(null==h.optional&&(h.optional={}),null==h.dynamic&&(h.dynamic={length:0}),h.dynamic[t]=n),u&&(h.optional[t]=n),n="",o=u=!1};++i!==s;)switch(r=t[i]){case"/":e();break;case":":o=!0;break;case"?":u=!0;break;default:n+=r}return e(),h},r.pRE=function(t,e){var r,n;return r=t.replace(/\//g,"\\/"),n="^"+t,e||(n+="$"),n=new RegExp(n),n.string=t,n.length=t.length,n},r.sRE=function(t){var e,n,o,i,s,u;for(i="",e=n=0,o=t.length;n<o;e=++n)u=t[e],(null!=(s=t.dynamic)?s[e]:void 0)?(u="[^/]+",1===t.length&&(u+="$"),i&&(u="/"+u),t.optional[e]&&(u="(?:"+u+")?")):i&&(i+="/"),i+=u;return r.pRE(i)},e.exports},t[4]=function(t){var e={exports:t},r,o,i;return r=n(6),i=n(2),e.exports=o=function(){function t(t,e,n){this.path=t,this.segments=e,this.router=n,this._ct=new r(this),this.eA=this._LAction=i.noop,this._As=[]}return t.prototype.entering=function(t){return this.eA=t,this},t.prototype.leaving=function(t){return this._LAction=t,this},t.prototype.to=function(t){return this._As.push(t),this},t.prototype.filters=function(t){return this._d=t,this},t.prototype.passive=function(){return this._ps=this.router._hp=!0,this},t.prototype.remove=function(){return this.router._removeRoute(this)},t.prototype._invokeAction=function(t,e,r){var n;return n=t.call(this._ct,e,r),n===this.router._P?null:n},t.prototype._R=function(t,e,r){return this._RP(t),Promise.resolve(this._invokeAction(this.eA,r,e)).then(function(t){return function(){return Promise.all(t._As.map(function(n){return t._invokeAction(n,r,e)}))}}(this))},t.prototype._L=function(t,e){return this._invokeAction(this._LAction,e,t)},t.prototype._RP=function(t){var e,r,n,o;if(this.segments.dynamic){t=i.rB(t,this.router._bp),o=t.split("/"),r=this.segments.dynamic;for(e in r)n=r[e],"length"!==e&&(this._ct.params[n]=o[e]||"")}},Object.defineProperties(t.prototype,{map:{get:function(){return this.router.map.bind(this.router)}},mapOnce:{get:function(){return this.router.mapOnce.bind(this.router)}},listen:{get:function(){return this.router.listen.bind(this.router)}}}),t}(),e.exports},t[6]=function(t){var e={exports:t},r;return e.exports=r=function(){function t(t){this.route=t,this.segments=this.route.segments,this.path=this.route.path.string,this.params={}}return t.prototype.remove=function(){return this.route.remove()},t.prototype.redirect=function(t){return this.route.router.go(t,"redirect"),Promise.resolve()},t}(),e.exports},n},t=t({},{},{}),function(){var e,r,n;return e=t(1),n=t(2),r=new function(){var t,r,o,i,s;return s=[],i=[],o=!1,t=0,r=function(t){var e,r,o,s,u,h,a,c,l,p,f,_,g;for(p=n.currentPath(),c=[],r=0,s=i.length;r<s;r++)_=i[r],_._bp&&!_._bp.test(p)||(g=n.rB(p,_._bp),(a=_._M(g))&&(a.constructor===Array?c.push.apply(c,a):c.push(a)));if(!c.length)for(o=0,u=i.length;o<u;o++)_=i[o],_._F&&(_._bp&&!_._bp.test(p)||c.push(_._F));for(e=Math.max.apply(Math,c.map(function(t){return t.router._p})),c=c.filter(function(t){return t.router._p===e}),l=0,h=c.length;l<h;l++)f=c[l],f.router.current.path!==p&&f.router._go(f,p,!0)},this._registerRouter=function(t,e){var s,u,h;if(i.push(t),o||(o=!0,void 0!==window.onhashchange&&(!document.documentMode||document.documentMode>=8)?window.addEventListener("hashchange",r):setInterval(r,100)),e){if(h=n.currentPath(),"string"==typeof e&&(s=n.cP(e)),t._bp&&!t._bp.test(h)&&!s)return;if(u=t._M(n.rB(h,t._bp)),!u&&s&&(u=t._M(s),h=s),null==u&&(u=t._F),u)return t._go(u,h,!0)}},this.killAll=function(){var t,e,r,n;for(n=s.slice(),t=0,e=n.length;t<e;t++)r=n[t],r.kill();s.length=0,i.length=0},this.Router=function(r){var n;return s.push(n=new e(r,++t)),n},this.version="1.1.0-alpha",this},null!=("undefined"!=typeof module&&null!==module?module.exports:void 0)?module.exports=r:"function"==typeof define&&define.amd?define(["routing.js"],function(){return r}):this.Routing=r}()}}(this)();